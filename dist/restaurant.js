let restaurant;var map;async function fillReviewsHTML(e){let t;const n=document.getElementById("reviews-container"),r=document.createElement("h2");r.innerHTML="Reviews",n.appendChild(r);const a=await getAllReviews();if(!a)throw new Error("Reviews does not exist");t=a.filter(t=>t.restaurant_id==e);if(!t){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void n.appendChild(e)}const l=document.getElementById("reviews-list");t.forEach(e=>{l.appendChild(createReviewHTML(e))}),n.appendChild(l)}async function postReview(e){await fetch("http://localhost:1337/reviews",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}),fetchRestaurantFromURL=(e=>{let t;if(self.restaurant)return void e(null,self.restaurant);const n=getParameterByName("id");n?DBHelper.fetchRestaurantById(n).then(n=>{t=n,self.restaurant=t,fillRestaurantHTML(),e(null,t)}).catch(e=>{console.log(e)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.setAttribute("alt",e.name),t.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML(e.id)}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);const l=document.createElement("td");l.innerHTML=e[n],r.appendChild(l),t.appendChild(r)}}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);const r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toDateString(),t.appendChild(r);const a=document.createElement("p");a.innerHTML=`Rating: ${e.rating}`,t.appendChild(a);const l=document.createElement("p");return l.innerHTML=e.comments,t.appendChild(l),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}),addReview=(()=>{event.preventDefault(),postReview({restaurant_id:getParameterByName("id"),name:document.getElementById("reviewer").value,rating:document.querySelector("#rating-selection option:checked").value,comments:document.getElementById("review-comments").value})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwiYXN5bmMiLCJmaWxsUmV2aWV3c0hUTUwiLCJyZXN0YXVyYW50SWQiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRpdGxlIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiYWxsUmV2aWV3cyIsImdldEFsbFJldmlld3MiLCJFcnJvciIsImZpbHRlciIsInIiLCJyZXN0YXVyYW50X2lkIiwibm9SZXZpZXdzIiwidWwiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsInBvc3RSZXZpZXciLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaGVhZGVycyIsIkNvbnRlbnQtVHlwZSIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJjb25zb2xlIiwic2VsZiIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJ6b29tIiwiY2VudGVyIiwibGF0bG5nIiwic2Nyb2xsd2hlZWwiLCJmaWxsQnJlYWRjcnVtYiIsIkRCSGVscGVyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImNhbGxiYWNrIiwiaWQiLCJnZXRQYXJhbWV0ZXJCeU5hbWUiLCJmZXRjaFJlc3RhdXJhbnRCeUlkIiwidGhlbiIsInJlc3VsdCIsImZpbGxSZXN0YXVyYW50SFRNTCIsImNhdGNoIiwiZXJyIiwibG9nIiwibmFtZSIsImFkZHJlc3MiLCJpbWFnZSIsImNsYXNzTmFtZSIsInNldEF0dHJpYnV0ZSIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImRheSIsInRpbWUiLCJsaSIsImRhdGUiLCJEYXRlIiwidXBkYXRlZEF0IiwidG9EYXRlU3RyaW5nIiwicmF0aW5nIiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwidXJsIiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsInJlc3VsdHMiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiYWRkUmV2aWV3IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwicXVlcnlTZWxlY3RvciJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsV0FDSixJQUFJQyxJQStGSkMsZUFBZUMsZ0JBQWdCQyxHQUM3QixJQUFJQyxFQUNKLE1BQU1DLEVBQVlDLFNBQVNDLGVBQWUscUJBQ3BDQyxFQUFRRixTQUFTRyxjQUFjLE1BQ3JDRCxFQUFNRSxVQUFZLFVBQ2xCTCxFQUFVTSxZQUFZSCxHQUd0QixNQUFNSSxRQUFtQkMsZ0JBRXpCLElBQUlELEVBSUYsTUFBTSxJQUFJRSxNQUFNLDBCQUZoQlYsRUFEZ0JRLEVBQVdHLE9BQU9DLEdBQUtBLEVBQUVDLGVBQWlCZCxHQU01RCxJQUFLQyxFQUFTLENBQ1osTUFBTWMsRUFBWVosU0FBU0csY0FBYyxLQUd6QyxPQUZBUyxFQUFVUixVQUFZLHVCQUN0QkwsRUFBVU0sWUFBWU8sR0FHeEIsTUFBTUMsRUFBS2IsU0FBU0MsZUFBZSxnQkFDbkNILEVBQVFnQixRQUFRQyxJQUNkRixFQUFHUixZQUFZVyxpQkFBaUJELE1BRWxDaEIsRUFBVU0sWUFBWVEsR0E0RXZCbEIsZUFBZXNCLFdBQVdGLFNBQ25CRyxNQUFNLGdDQUFpQyxDQUMzQ0MsT0FBUSxPQUNSQyxLQUFNQyxLQUFLQyxVQUFVUCxHQUNyQlEsUUFBUSxDQUNOQyxlQUFnQixzQkF0TXRCQyxPQUFPQyxRQUFVLE1BQ2ZDLHVCQUF1QixDQUFDQyxFQUFPbkMsS0FDekJtQyxFQUNGQyxRQUFRRCxNQUFNQSxJQUVkRSxLQUFLcEMsSUFBTSxJQUFJcUMsT0FBT0MsS0FBS0MsSUFBSWpDLFNBQVNDLGVBQWUsT0FBUSxDQUM3RGlDLEtBQU0sR0FDTkMsT0FBUTFDLEVBQVcyQyxPQUNuQkMsYUFBYSxJQUVmQyxpQkFDQUMsU0FBU0MsdUJBQXVCVixLQUFLckMsV0FBWXFDLEtBQUtwQyxVQVE1RGlDLHVCQUF5QixDQUFDYyxJQUN4QixJQUFJaEQsRUFDSixHQUFJcUMsS0FBS3JDLFdBRVAsWUFEQWdELEVBQVMsS0FBTVgsS0FBS3JDLFlBR3RCLE1BQU1pRCxFQUFLQyxtQkFBbUIsTUFDekJELEVBSUhILFNBQVNLLG9CQUFvQkYsR0FBSUcsS0FBTUMsSUFDckNyRCxFQUFhcUQsRUFDYmhCLEtBQUtyQyxXQUFhQSxFQUNsQnNELHFCQUNBTixFQUFTLEtBQU1oRCxLQUNkdUQsTUFBT0MsSUFDUnBCLFFBQVFxQixJQUFJRCxNQVRkckIsTUFBUSwwQkFDUmEsRUFBU2IsTUFBTyxTQWdCcEJtQixtQkFBcUIsRUFBQ3RELEVBQWFxQyxLQUFLckMsY0FDekJPLFNBQVNDLGVBQWUsbUJBQ2hDRyxVQUFZWCxFQUFXMEQsS0FFWm5ELFNBQVNDLGVBQWUsc0JBQ2hDRyxVQUFZWCxFQUFXMkQsUUFFL0IsTUFBTUMsRUFBUXJELFNBQVNDLGVBQWUsa0JBQ3RDb0QsRUFBTUMsVUFBWSxpQkFDbEJELEVBQU1FLGFBQWEsTUFBTzlELEVBQVcwRCxNQUNyQ0UsRUFBTUcsSUFBTWpCLFNBQVNrQixzQkFBc0JoRSxHQUUzQk8sU0FBU0MsZUFBZSxzQkFDaENHLFVBQVlYLEVBQVdpRSxhQUczQmpFLEVBQVdrRSxpQkFDYkMsMEJBR0ZoRSxnQkFBZ0JILEVBQVdpRCxNQU03QmtCLHdCQUEwQixFQUFDQyxFQUFpQi9CLEtBQUtyQyxXQUFXa0UsbUJBQzFELE1BQU1HLEVBQVE5RCxTQUFTQyxlQUFlLG9CQUN0QyxJQUFLLElBQUk4RCxLQUFPRixFQUFnQixDQUM5QixNQUFNRyxFQUFNaEUsU0FBU0csY0FBYyxNQUU3QjhELEVBQU1qRSxTQUFTRyxjQUFjLE1BQ25DOEQsRUFBSTdELFVBQVkyRCxFQUNoQkMsRUFBSTNELFlBQVk0RCxHQUVoQixNQUFNQyxFQUFPbEUsU0FBU0csY0FBYyxNQUNwQytELEVBQUs5RCxVQUFZeUQsRUFBZUUsR0FDaENDLEVBQUkzRCxZQUFZNkQsR0FFaEJKLEVBQU16RCxZQUFZMkQsTUF3Q3RCaEQsaUJBQW1CLENBQUNELElBQ2xCLE1BQU1vRCxFQUFLbkUsU0FBU0csY0FBYyxNQUM1QmdELEVBQU9uRCxTQUFTRyxjQUFjLEtBQ3BDZ0QsRUFBSy9DLFVBQVlXLEVBQU9vQyxLQUN4QmdCLEVBQUc5RCxZQUFZOEMsR0FFZixNQUFNaUIsRUFBT3BFLFNBQVNHLGNBQWMsS0FDcENpRSxFQUFLaEUsVUFBWSxJQUFJaUUsS0FBS3RELEVBQU91RCxXQUFXQyxlQUM1Q0osRUFBRzlELFlBQVkrRCxHQUVmLE1BQU1JLEVBQVN4RSxTQUFTRyxjQUFjLEtBQ3RDcUUsRUFBT3BFLHFCQUF1QlcsRUFBT3lELFNBQ3JDTCxFQUFHOUQsWUFBWW1FLEdBRWYsTUFBTUMsRUFBV3pFLFNBQVNHLGNBQWMsS0FJeEMsT0FIQXNFLEVBQVNyRSxVQUFZVyxFQUFPMEQsU0FDNUJOLEVBQUc5RCxZQUFZb0UsR0FFUk4sSUFNVDdCLGVBQWlCLEVBQUM3QyxFQUFhcUMsS0FBS3JDLGNBQ2xDLE1BQU1pRixFQUFhMUUsU0FBU0MsZUFBZSxjQUNyQ2tFLEVBQUtuRSxTQUFTRyxjQUFjLE1BQ2xDZ0UsRUFBRy9ELFVBQVlYLEVBQVcwRCxLQUMxQnVCLEVBQVdyRSxZQUFZOEQsS0FNekJ4QixtQkFBcUIsRUFBQ1EsRUFBTXdCLEtBQ3JCQSxJQUNIQSxFQUFNbEQsT0FBT21ELFNBQVNDLE1BQ3hCMUIsRUFBT0EsRUFBSzJCLFFBQVEsVUFBVyxRQUMvQixNQUNFQyxFQURZLElBQUlDLGNBQWM3QixzQkFDZDhCLEtBQUtOLEdBQ3ZCLE9BQUtJLEVBRUFBLEVBQVEsR0FFTkcsbUJBQW1CSCxFQUFRLEdBQUdELFFBQVEsTUFBTyxNQUQzQyxHQUZBLE9BU1hLLFVBQVksTUFFVkMsTUFBTUMsaUJBWU5wRSxXQU5lLENBQ2JOLGNBTGlCZ0MsbUJBQW1CLE1BTXBDUSxLQUxTbkQsU0FBU0MsZUFBZSxZQUFZcUYsTUFNN0NkLE9BTFd4RSxTQUFTdUYsY0FBYyxvQ0FBb0NELE1BTXRFYixTQUxhekUsU0FBU0MsZUFBZSxtQkFBbUJxRiIsImZpbGUiOiJyZXN0YXVyYW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnQ7XG52YXIgbWFwO1xuXG4vKipcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cbiAqL1xud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XG4gIGZldGNoUmVzdGF1cmFudEZyb21VUkwoKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm1hcCk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcbiAgbGV0IHJlc3RhdXJhbnRcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuICBpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkKS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgIHJlc3RhdXJhbnQgPSByZXN1bHRcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnRcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcbiAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgfSlcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpO1xuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnXG4gIGltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCByZXN0YXVyYW50Lm5hbWUpXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcblxuICBjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XG4gIH1cbiAgLy8gZmlsbCByZXZpZXdzIG5ld2VyIHZlcnNpb25zIG5vdyBuZWVkcyByZXN0YXVyYW50IGlkIHRvIHBhc3NlZFxuICBmaWxsUmV2aWV3c0hUTUwocmVzdGF1cmFudC5pZCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XG4gIGNvbnN0IGhvdXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaG91cnMnKTtcbiAgZm9yIChsZXQga2V5IGluIG9wZXJhdGluZ0hvdXJzKSB7XG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcblxuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgZGF5LmlubmVySFRNTCA9IGtleTtcbiAgICByb3cuYXBwZW5kQ2hpbGQoZGF5KTtcblxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgIHRpbWUuaW5uZXJIVE1MID0gb3BlcmF0aW5nSG91cnNba2V5XTtcbiAgICByb3cuYXBwZW5kQ2hpbGQodGltZSk7XG5cbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG5hc3luYyBmdW5jdGlvbiBmaWxsUmV2aWV3c0hUTUwocmVzdGF1cmFudElkKSB7XG4gIGxldCByZXZpZXdzO1xuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICB0aXRsZS5pbm5lckhUTUwgPSAnUmV2aWV3cyc7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gIC8vIFRoaXMgZnVuY3Rpb24gd2FzIG1vZGlmaWVkIHRvIGJlIGFibGUgdG8gZ2V0IGFsbHJldmlld3MgZnJvbVxuICAvLyBpbmRleGVkREIgYW5kIGZpbHRlciBvdXQgYnkgcmVzdGF1cmFudElkXG4gIGNvbnN0IGFsbFJldmlld3MgPSBhd2FpdCBnZXRBbGxSZXZpZXdzKCk7XG5cbiAgaWYgKGFsbFJldmlld3MpIHtcbiAgICBjb25zdCByZXN1bHRzID0gYWxsUmV2aWV3cy5maWx0ZXIociA9PiByLnJlc3RhdXJhbnRfaWQgPT0gcmVzdGF1cmFudElkKTtcbiAgICByZXZpZXdzID0gcmVzdWx0c1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcignUmV2aWV3cyBkb2VzIG5vdCBleGlzdCcpXG4gIH1cblxuICBpZiAoIXJldmlld3MpIHtcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgbm9SZXZpZXdzLmlubmVySFRNTCA9ICdObyByZXZpZXdzIHlldCEnO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChub1Jldmlld3MpO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWxpc3QnKTtcbiAgcmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG4gICAgdWwuYXBwZW5kQ2hpbGQoY3JlYXRlUmV2aWV3SFRNTChyZXZpZXcpKTtcbiAgfSk7XG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh1bCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSk7XG5cbiAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgZGF0ZS5pbm5lckhUTUwgPSBuZXcgRGF0ZShyZXZpZXcudXBkYXRlZEF0KS50b0RhdGVTdHJpbmcoKTtcbiAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSk7XG5cbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XG5cbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuXG4gIHJldHVybiBsaTtcbn1cblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG5maWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XG59XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xuICBpZiAoIXVybClcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmICghcmVzdWx0c1syXSlcbiAgICByZXR1cm4gJyc7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XG59XG5cbi8qKlxuICogR2V0IHRoZSB2YWx1ZXMgZnJvbSB0aGUgcmV2aWV3IGZvcm1cbiAqL1xuYWRkUmV2aWV3ID0gKCkgPT4ge1xuICAvLyBQcmV2ZW50aW5nIGRlZmF1bCBiZWhhdmlvclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAvLyBSZXRyaXZpbmcgbmVzc2VzYXJ5IGRhdGEgZnJvbSBvdXIgZm9ybVxuICBsZXQgcmVzdGF1cmFudElkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuICBsZXQgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdlcicpLnZhbHVlO1xuICBsZXQgcmF0aW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JhdGluZy1zZWxlY3Rpb24gb3B0aW9uOmNoZWNrZWQnKS52YWx1ZTtcbiAgbGV0IGNvbW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlldy1jb21tZW50cycpLnZhbHVlXG4gIGNvbnN0IHJldmlldyA9IHtcbiAgICAncmVzdGF1cmFudF9pZCc6IHJlc3RhdXJhbnRJZCxcbiAgICAnbmFtZSc6IG5hbWUsXG4gICAgJ3JhdGluZyc6IHJhdGluZyxcbiAgICAnY29tbWVudHMnOiBjb21tZW50c1xuICB9XG4gIHBvc3RSZXZpZXcocmV2aWV3KTtcbn1cblxuLyoqXG4gKiBQT1NUIG5ldyByZXZpZXdcbiAqL1xuIGFzeW5jIGZ1bmN0aW9uIHBvc3RSZXZpZXcocmV2aWV3KSB7XG4gIGF3YWl0IGZldGNoKCdodHRwOi8vbG9jYWxob3N0OjEzMzcvcmV2aWV3cycsIHtcbiAgICBtZXRob2Q6ICdQT1NUJywgXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmV2aWV3KSxcbiAgICBoZWFkZXJzOntcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9XG4gIH0pXG4gfSJdfQ==
