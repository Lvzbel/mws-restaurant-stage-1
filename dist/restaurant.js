let restaurant;var map;async function fillReviewsHTML(e){let t;const n=document.getElementById("reviews-container"),r=document.createElement("h2");r.innerHTML="Reviews",n.appendChild(r);const a=await getAllReviews();if(!a)throw new Error("Reviews does not exist");t=a.filter(t=>t.restaurant_id==e);if(!t){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void n.appendChild(e)}const l=document.getElementById("reviews-list");t.forEach(e=>{l.appendChild(createReviewHTML(e))}),n.appendChild(l)}window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}),fetchRestaurantFromURL=(e=>{let t;if(self.restaurant)return void e(null,self.restaurant);const n=getParameterByName("id");n?DBHelper.fetchRestaurantById(n).then(n=>{t=n,self.restaurant=t,fillRestaurantHTML(),e(null,t)}).catch(e=>{console.log(e)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.setAttribute("alt",e.name),t.src=DBHelper.imageUrlForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML(e.id)}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const r=document.createElement("tr"),a=document.createElement("td");a.innerHTML=n,r.appendChild(a);const l=document.createElement("td");l.innerHTML=e[n],r.appendChild(l),t.appendChild(r)}}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);const r=document.createElement("p");r.innerHTML=new Date(e.updatedAt).toDateString(),t.appendChild(r);const a=document.createElement("p");a.innerHTML=`Rating: ${e.rating}`,t.appendChild(a);const l=document.createElement("p");return l.innerHTML=e.comments,t.appendChild(l),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwiYXN5bmMiLCJmaWxsUmV2aWV3c0hUTUwiLCJyZXN0YXVyYW50SWQiLCJyZXZpZXdzIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRpdGxlIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiYWxsUmV2aWV3cyIsImdldEFsbFJldmlld3MiLCJFcnJvciIsImZpbHRlciIsInIiLCJyZXN0YXVyYW50X2lkIiwibm9SZXZpZXdzIiwidWwiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsIndpbmRvdyIsImluaXRNYXAiLCJmZXRjaFJlc3RhdXJhbnRGcm9tVVJMIiwiZXJyb3IiLCJjb25zb2xlIiwic2VsZiIsImdvb2dsZSIsIm1hcHMiLCJNYXAiLCJ6b29tIiwiY2VudGVyIiwibGF0bG5nIiwic2Nyb2xsd2hlZWwiLCJmaWxsQnJlYWRjcnVtYiIsIkRCSGVscGVyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImNhbGxiYWNrIiwiaWQiLCJnZXRQYXJhbWV0ZXJCeU5hbWUiLCJmZXRjaFJlc3RhdXJhbnRCeUlkIiwidGhlbiIsInJlc3VsdCIsImZpbGxSZXN0YXVyYW50SFRNTCIsImNhdGNoIiwiZXJyIiwibG9nIiwibmFtZSIsImFkZHJlc3MiLCJpbWFnZSIsImNsYXNzTmFtZSIsInNldEF0dHJpYnV0ZSIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImN1aXNpbmVfdHlwZSIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwib3BlcmF0aW5nSG91cnMiLCJob3VycyIsImtleSIsInJvdyIsImRheSIsInRpbWUiLCJsaSIsImRhdGUiLCJEYXRlIiwidXBkYXRlZEF0IiwidG9EYXRlU3RyaW5nIiwicmF0aW5nIiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwidXJsIiwibG9jYXRpb24iLCJocmVmIiwicmVwbGFjZSIsInJlc3VsdHMiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUNKLElBQUlDLElBK0ZKQyxlQUFlQyxnQkFBaUJDLEdBQzlCLElBQUlDLEVBQ0osTUFBTUMsRUFBWUMsU0FBU0MsZUFBZSxxQkFDcENDLEVBQVFGLFNBQVNHLGNBQWMsTUFDckNELEVBQU1FLFVBQVksVUFDbEJMLEVBQVVNLFlBQVlILEdBR3RCLE1BQU1JLFFBQW1CQyxnQkFFdkIsSUFBSUQsRUFJRixNQUFNLElBQUlFLE1BQU0sMEJBRmhCVixFQURnQlEsRUFBV0csT0FBT0MsR0FBS0EsRUFBRUMsZUFBaUJkLEdBTTlELElBQUtDLEVBQVMsQ0FDWixNQUFNYyxFQUFZWixTQUFTRyxjQUFjLEtBR3pDLE9BRkFTLEVBQVVSLFVBQVksdUJBQ3RCTCxFQUFVTSxZQUFZTyxHQUd4QixNQUFNQyxFQUFLYixTQUFTQyxlQUFlLGdCQUNuQ0gsRUFBUWdCLFFBQVFDLElBQ2RGLEVBQUdSLFlBQVlXLGlCQUFpQkQsTUFFbENoQixFQUFVTSxZQUFZUSxHQXJIeEJJLE9BQU9DLFFBQVUsTUFDZkMsdUJBQXVCLENBQUNDLEVBQU8zQixLQUN6QjJCLEVBQ0ZDLFFBQVFELE1BQU1BLElBRWRFLEtBQUs1QixJQUFNLElBQUk2QixPQUFPQyxLQUFLQyxJQUFJekIsU0FBU0MsZUFBZSxPQUFRLENBQzdEeUIsS0FBTSxHQUNOQyxPQUFRbEMsRUFBV21DLE9BQ25CQyxhQUFhLElBRWZDLGlCQUNBQyxTQUFTQyx1QkFBdUJWLEtBQUs3QixXQUFZNkIsS0FBSzVCLFVBUTVEeUIsdUJBQXlCLENBQUNjLElBQ3hCLElBQUl4QyxFQUNKLEdBQUk2QixLQUFLN0IsV0FFUCxZQURBd0MsRUFBUyxLQUFNWCxLQUFLN0IsWUFHdEIsTUFBTXlDLEVBQUtDLG1CQUFtQixNQUN6QkQsRUFJSEgsU0FBU0ssb0JBQW9CRixHQUFJRyxLQUFNQyxJQUNyQzdDLEVBQWE2QyxFQUNiaEIsS0FBSzdCLFdBQWFBLEVBQ2xCOEMscUJBQ0FOLEVBQVMsS0FBTXhDLEtBQ2QrQyxNQUFPQyxJQUNScEIsUUFBUXFCLElBQUlELE1BVGRyQixNQUFRLDBCQUNSYSxFQUFTYixNQUFPLFNBZ0JwQm1CLG1CQUFxQixFQUFDOUMsRUFBYTZCLEtBQUs3QixjQUN6Qk8sU0FBU0MsZUFBZSxtQkFDaENHLFVBQVlYLEVBQVdrRCxLQUVaM0MsU0FBU0MsZUFBZSxzQkFDaENHLFVBQVlYLEVBQVdtRCxRQUUvQixNQUFNQyxFQUFRN0MsU0FBU0MsZUFBZSxrQkFDdEM0QyxFQUFNQyxVQUFZLGlCQUNsQkQsRUFBTUUsYUFBYSxNQUFPdEQsRUFBV2tELE1BQ3JDRSxFQUFNRyxJQUFNakIsU0FBU2tCLHNCQUFzQnhELEdBRTNCTyxTQUFTQyxlQUFlLHNCQUNoQ0csVUFBWVgsRUFBV3lELGFBRzNCekQsRUFBVzBELGlCQUNiQywwQkFHRnhELGdCQUFnQkgsRUFBV3lDLE1BTTdCa0Isd0JBQTBCLEVBQUNDLEVBQWlCL0IsS0FBSzdCLFdBQVcwRCxtQkFDMUQsTUFBTUcsRUFBUXRELFNBQVNDLGVBQWUsb0JBQ3RDLElBQUssSUFBSXNELEtBQU9GLEVBQWdCLENBQzlCLE1BQU1HLEVBQU14RCxTQUFTRyxjQUFjLE1BRTdCc0QsRUFBTXpELFNBQVNHLGNBQWMsTUFDbkNzRCxFQUFJckQsVUFBWW1ELEVBQ2hCQyxFQUFJbkQsWUFBWW9ELEdBRWhCLE1BQU1DLEVBQU8xRCxTQUFTRyxjQUFjLE1BQ3BDdUQsRUFBS3RELFVBQVlpRCxFQUFlRSxHQUNoQ0MsRUFBSW5ELFlBQVlxRCxHQUVoQkosRUFBTWpELFlBQVltRCxNQXdDdEJ4QyxpQkFBbUIsQ0FBQ0QsSUFDbEIsTUFBTTRDLEVBQUszRCxTQUFTRyxjQUFjLE1BQzVCd0MsRUFBTzNDLFNBQVNHLGNBQWMsS0FDcEN3QyxFQUFLdkMsVUFBWVcsRUFBTzRCLEtBQ3hCZ0IsRUFBR3RELFlBQVlzQyxHQUVmLE1BQU1pQixFQUFPNUQsU0FBU0csY0FBYyxLQUNwQ3lELEVBQUt4RCxVQUFZLElBQUl5RCxLQUFLOUMsRUFBTytDLFdBQVdDLGVBQzVDSixFQUFHdEQsWUFBWXVELEdBRWYsTUFBTUksRUFBU2hFLFNBQVNHLGNBQWMsS0FDdEM2RCxFQUFPNUQscUJBQXVCVyxFQUFPaUQsU0FDckNMLEVBQUd0RCxZQUFZMkQsR0FFZixNQUFNQyxFQUFXakUsU0FBU0csY0FBYyxLQUl4QyxPQUhBOEQsRUFBUzdELFVBQVlXLEVBQU9rRCxTQUM1Qk4sRUFBR3RELFlBQVk0RCxHQUVSTixJQU1UN0IsZUFBaUIsRUFBQ3JDLEVBQWE2QixLQUFLN0IsY0FDbEMsTUFBTXlFLEVBQWFsRSxTQUFTQyxlQUFlLGNBQ3JDMEQsRUFBSzNELFNBQVNHLGNBQWMsTUFDbEN3RCxFQUFHdkQsVUFBWVgsRUFBV2tELEtBQzFCdUIsRUFBVzdELFlBQVlzRCxLQU16QnhCLG1CQUFxQixFQUFDUSxFQUFNd0IsS0FDckJBLElBQ0hBLEVBQU1sRCxPQUFPbUQsU0FBU0MsTUFDeEIxQixFQUFPQSxFQUFLMkIsUUFBUSxVQUFXLFFBQy9CLE1BQ0VDLEVBRFksSUFBSUMsY0FBYzdCLHNCQUNkOEIsS0FBS04sR0FDdkIsT0FBS0ksRUFFQUEsRUFBUSxHQUVORyxtQkFBbUJILEVBQVEsR0FBR0QsUUFBUSxNQUFPLE1BRDNDLEdBRkEiLCJmaWxlIjoicmVzdGF1cmFudC5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50O1xudmFyIG1hcDtcblxuLyoqXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXG4gKi9cbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuICAgICAgICB6b29tOiAxNixcbiAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XG4gICAgICBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHNlbGYucmVzdGF1cmFudCwgc2VsZi5tYXApO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxuICovXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XG4gIGxldCByZXN0YXVyYW50XG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcbiAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XG4gIH0gZWxzZSB7XG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICByZXN0YXVyYW50ID0gcmVzdWx0XG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50XG4gICAgICBmaWxsUmVzdGF1cmFudEhUTUwoKTtcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgIH0pXG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2VcbiAqL1xuZmlsbFJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LW5hbWUnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG5cbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKTtcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XG5cbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJ1xuICBpbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgcmVzdGF1cmFudC5uYW1lKVxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuICB9XG4gIC8vIGZpbGwgcmV2aWV3cyBuZXdlciB2ZXJzaW9ucyBub3cgbmVlZHMgcmVzdGF1cmFudCBpZCB0byBwYXNzZWRcbiAgZmlsbFJldmlld3NIVE1MKHJlc3RhdXJhbnQuaWQpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IG9wZXJhdGluZyBob3VycyBIVE1MIHRhYmxlIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXN0YXVyYW50SG91cnNIVE1MID0gKG9wZXJhdGluZ0hvdXJzID0gc2VsZi5yZXN0YXVyYW50Lm9wZXJhdGluZ19ob3VycykgPT4ge1xuICBjb25zdCBob3VycyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWhvdXJzJyk7XG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG5cbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgIGRheS5pbm5lckhUTUwgPSBrZXk7XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xuXG4gICAgaG91cnMuYXBwZW5kQ2hpbGQocm93KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZmlsbFJldmlld3NIVE1MIChyZXN0YXVyYW50SWQpIHtcbiAgbGV0IHJldmlld3M7XG4gIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXZpZXdzLWNvbnRhaW5lcicpO1xuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gIHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRpdGxlKTtcbiAgLy8gVGhpcyBmdW5jdGlvbiB3YXMgbW9kaWZpZWQgdG8gYmUgYWJsZSB0byBnZXQgYWxscmV2aWV3cyBmcm9tXG4gIC8vIGluZGV4ZWREQiBhbmQgZmlsdGVyIG91dCBieSByZXN0YXVyYW50SWRcbiAgY29uc3QgYWxsUmV2aWV3cyA9IGF3YWl0IGdldEFsbFJldmlld3MoKTtcblxuICAgIGlmIChhbGxSZXZpZXdzKSB7XG4gICAgICBjb25zdCByZXN1bHRzID0gYWxsUmV2aWV3cy5maWx0ZXIociA9PiByLnJlc3RhdXJhbnRfaWQgPT0gcmVzdGF1cmFudElkKTtcbiAgICAgIHJldmlld3MgPSByZXN1bHRzXG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmV2aWV3cyBkb2VzIG5vdCBleGlzdCcpXG4gICAgfVxuXG4gIGlmICghcmV2aWV3cykge1xuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xuICB9KTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBkYXRlLmlubmVySFRNTCA9IG5ldyBEYXRlKHJldmlldy51cGRhdGVkQXQpLnRvRGF0ZVN0cmluZygpO1xuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XG5cbiAgcmV0dXJuIGxpO1xufVxuXG4vKipcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XG4gKi9cbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQgPSBzZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdicmVhZGNydW1iJyk7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcbn1cblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gIGlmICghdXJsKVxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG4gIGlmICghcmVzdWx0cylcbiAgICByZXR1cm4gbnVsbDtcbiAgaWYgKCFyZXN1bHRzWzJdKVxuICAgIHJldHVybiAnJztcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn0iXX0=
